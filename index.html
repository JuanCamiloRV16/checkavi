<!doctype html>
<html lang="es">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Bootstrap CSS -->
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<!-- JavaScript & JQuery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<!-- jsPDF -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>

	<title>CheckAvi</title>
</head>

<body>
	<div id="contentToPrint">
		<div class="container-fluid p-5 bg-primary text-white text-center">
			<div class="jumbotron">
				<h2>CheckAvi - Checklist de Accesibilidad en Videojuegos</h2>
				<br>
				<p>Mediante esta lista de verificación puede identificar las características de accesibilidad que ya tiene o que le falta por incluir en un videojuego</p>
			</div>
		</div>

		<div class="container mt-5">
			<div class="row justify-content-md-center">
				<div class="col-6">
					<div class="input-group mb-3">
						<span class="input-group-text" id="inputGroup-sizing-default">Nombre del videojuego:</span>
						<input type="text" class="form-control" aria-label="Sizing example input"
							aria-describedby="inputGroup-sizing-default">
					</div>
				</div>
			</div>
			<br>
			<div class="row justify-content-md-center">
				<div class="col-6">
					<div class="form-check form-switch">
						<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" value="12">
						<label class="form-check-label" for="flexSwitchCheckDefault">Sensibilidad ajustable / tolerancia al error</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" value="12">
						<label class="form-check-label" for="flexSwitchCheckDefault">Uso de lenguaje simple</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" value="12">
						<label class="form-check-label" for="flexSwitchCheckDefault">Repetición de voz y/o textos</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" value="7">
						<label class="form-check-label" for="flexSwitchCheckDefault">Subtítulos</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" value="12">
						<label class="form-check-label" for="flexSwitchCheckDefault">Pausa mientras el texto está siendo leído</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" value="7">
						<label class="form-check-label" for="flexSwitchCheckDefault">Puntos de guardado</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" value="7">
						<label class="form-check-label" for="flexSwitchCheckDefault">Uso explícito de recompensas visuales</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" value="12">
						<label class="form-check-label" for="flexSwitchCheckDefault">Niveles de dificultad</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" value="12">
						<label class="form-check-label" for="flexSwitchCheckDefault">Repetición de desafíos</label>
					</div>
					<div class="form-check form-switch">
						<input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" value="7">
						<label class="form-check-label" for="flexSwitchCheckDefault">Alto contraste</label>
					</div>
				</div>
			</div>
			<br>
			<br>
			<div class="row justify-content-md-center">
				<div class="col-6">
					<div class="progress">
						<div id="bar" class="progress-bar progress-bar-striped active" role="progressbar"
							aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
						</div>
					</div>
				</div>
			</div>
			<br>
			<br>	
		</div>
	</div>
	<div class="row text-center">
		<div class="col-sm-12">
			<button onclick="exportPDF();" type="button" class="btn btn-primary">Descargar reporte</button>
		</div>
	</div>

	<script>
		$('input').on('click', function () {
			var emptyValue = 0;
			$('input:checked').each(function () {
				emptyValue += parseInt($(this).val());
			});
			$('.progress-bar').css('width', emptyValue + '%').attr('aria-valuenow', emptyValue).html(emptyValue + '%');;
		});

		function exportPDF() {
			var pdf = new jsPDF('l', 'px'),source = $('#contentToPrint')[0];
			var canvasToImage = function (canvas) {
				var img = new Image();
				var dataURL = canvas.toDataURL('image/png');
				img.src = dataURL;
				return img;
			};
			var canvasShiftImage = function (oldCanvas, shiftAmt) {
				shiftAmt = parseInt(shiftAmt) || 0;
				if (!shiftAmt) {
					return oldCanvas;
				}
				var newCanvas = document.createElement('canvas');
				newCanvas.height = oldCanvas.height - shiftAmt;
				newCanvas.width = oldCanvas.width;
				var ctx = newCanvas.getContext('2d');
				var img = canvasToImage(oldCanvas);
				ctx.drawImage(img, 0, shiftAmt, img.width, img.height, 0, 0, img.width, img.height);
				return newCanvas;
			};
			var canvasToImageSuccess = function (canvas) {
				var pdf = new jsPDF('l', 'px'),
					pdfInternals = pdf.internal,
					pdfPageSize = pdfInternals.pageSize,
					pdfScaleFactor = pdfInternals.scaleFactor,
					pdfPageWidth = pdfPageSize.width,
					pdfPageHeight = pdfPageSize.height,
					totalPdfHeight = 0,
					htmlPageHeight = canvas.height,
					htmlScaleFactor = canvas.width / (pdfPageWidth * pdfScaleFactor),
					safetyNet = 0;
				while (totalPdfHeight < htmlPageHeight && safetyNet < 15) {
					var newCanvas = canvasShiftImage(canvas, totalPdfHeight);
					pdf.addImage(newCanvas, 'png', 0, 0, pdfPageWidth, 0, null, 'NONE');
					totalPdfHeight += (pdfPageHeight * pdfScaleFactor * htmlScaleFactor);
					if (totalPdfHeight < htmlPageHeight) {
						pdf.addPage();
					}
					safetyNet++;
				}
				pdf.save('reporte_accesibilidad.pdf');
			};
			html2canvas(source, {
				onrendered: function (canvas) {
					canvasToImageSuccess(canvas);
				}
			});
		}
	</script>

</body>

</html>
